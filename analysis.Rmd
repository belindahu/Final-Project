---
title: "Final Project"
author: "Belinda Hu"
date: "4/25/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
library(tidyselect)
library(readr)
library(tidycensus)
library(gt)
library(scales)
library(ggplot2)
library(sf)
library(date)
library(gganimate)
library(skimr)
library(broom)

census_api_key("03bf7eeb14e29c5d6fd4073fce357ba84f0017cc")

```

```{r load crunchbase data, echo = FALSE, message = FALSE}

# loading in companies and deselecting irrelevant rows.
# using message =  FALSE to get rid of parsing failure

companies <- read_csv("raw-data/companies.csv",
                      col_types = cols(
  permalink = col_character(),
  name = col_character(),
  homepage_url = col_character(),
  category_list = col_character(),
  funding_total_usd = col_character(),
  status = col_character(),
  country_code = col_character(),
  state_code = col_character(),
  region = col_character(),
  city = col_character(),
  funding_rounds = col_double(),
  founded_at = col_date(format = ""),
  first_funding_at = col_date(format = ""),
  last_funding_at = col_date(format = "")
)) %>% 
  select(-permalink, -homepage_url, -count, -formula) %>% 
  filter(country_code == "USA")

# loading in funding, added in a funding year column for future purposes,
# changed $ to be in terms of ten millions

investments <- read_csv("raw-data/investments.csv") %>% 
  select(-company_permalink, -investor_permalink, -funding_round_permalink) %>% 
  mutate(funding_year = as.numeric(format(funded_at, "%Y"))) %>% 
  mutate(raised_amount_usd = raised_amount_usd/1000000)

```

# Exploratory Analysis of Data

## Types of startups by state 

```{r tidy, echo = FALSE}

# need to unlist category_code using separate and regex expressions separated
# category list into separate columns, calculated the max number of columns in
# excel. then used pivot_longer to lengthen the table to make calculating much
# easier later
 
companies2 <- companies %>% 
 separate(data = ., 
           col = category_list, 
           into = c("cat_1", "cat_2", "cat_3","cat_4", "cat_5", "cat_6", "cat_7", "cat_8", "cat_9", "cat_10", "cat_11", "cat_12", "cat_13", "cat_14", "cat_15", "cat_16", "cat_17", "cat_18", "cat_19", "cat_20", "cat_21", "cat_22", "cat_23", "cat_24", "cat_25", "cat_26", "cat_27", "cat_28", "cat_29", "cat_30", "cat_31", "cat_32", "cat_33", "cat_34", "cat_35", "cat_36", "cat_37", "cat_38", "cat_39", "cat_40", "cat_41", "cat_42", "cat_43", "cat_44"),
           sep = "([\\|])", 
           extra = "merge", 
           fill = "right") %>% 
  pivot_longer(
    cols = starts_with("cat_"),
    names_to = "cat_num",
    names_prefix = "cat_",
    values_to = "category",
    values_drop_na = TRUE
 )

```

```{r top types table, echo = FALSE}

# need to convert state abbr to name:
# https://worldpopulationreview.com/states/state-abbreviations/

stateabbr <- read_csv("raw-data/stateabbr.csv")%>% 
  select(State, Code)

# creating top_types by filtering for all existing state_codes, grouping by
# state, counting by category, calculating proportion, slicing max for each
# group, and left_joining with stateabbr. Used na.omit() to get rid of Guam.

top_types <- companies2 %>% 
  filter(! is.na(state_code)) %>% 
  group_by(state_code) %>% 
  count(category, sort = TRUE) %>% 
  mutate(percent = n/sum(n)) %>% 
  slice(which.max(n)) %>% 
  left_join(stateabbr,
            by = c("state_code" = "Code")) %>% 
  na.omit()

# creating a gt table of top_types

# top_types_table <- top_types %>% 
#   select(category, percent, State) %>% 
#   ungroup() %>% 
#   gt() %>% 
#   tab_header(
#     title = "Most Prevalent Startup Categories by State",
#     subtitle = "Startups can have multiple categories"
#   ) %>% 
#   cols_move_to_start(
#     columns = vars(state_code, State)
#   ) %>% 
#   cols_label(
#     state_code = "State Code",
#     State = "State",
#     category = "Category",
#     percent = "Prevalence"
#   ) %>% 
#   fmt_percent(
#     columns = vars(percent)
#   ) %>% 
#   cols_align(
#     "center"
#   ) %>% 
#   tab_footnote(
#     footnote = "Data from Dec. 4, 2015 Crunchbase Data Report",
#     locations = cells_title("title"))
# 
# top_types_table
  
```

## Total Distribution of Industries in US

```{r total distribution, echo = FALSE}

# Mapping total distribution of startup types in the US

# companies2 %>% 
#   group_by(category) %>% 
#   count() %>% 
#   summarise(distr = n/86403) %>% 
#   arrange(desc(distr)) %>% 
#   head(15) %>% 
#   gt() %>% 
#   tab_header(
#     title = "Distribution of Startup Categories Across the US",
#     subtitle = "Startups can have multiple categories"
#   ) %>% 
#   cols_label(
#     category = "Category",
#     distr = "Distribution"
#   ) %>% 
#   fmt_percent(
#     columns = vars(distr)
#   ) %>% 
#   cols_align(
#     "center"
#   ) %>% 
#   tab_footnote(
#     footnote = "Data from Dec. 4, 2015 Crunchbase Data Report",
#     locations = cells_title("title"))

```

## Distribution of Funding Amongst Industries

```{r top types map, echo = FALSE, options(tigris_use_cache = TRUE)}


# income <- get_acs(geography = "state",
#                         variables = "B19013_001",
#                         year = 2015,
#                         geometry = TRUE) 
# 
# pop <- get_acs(geography = "state",
#                         variables = "B02001_001",
#                         year = 2015,
#                         geometry = TRUE) 


```

# Visualizing Investments

## total investments over the years

```{r investments over the year, echo = FALSE}

# using na.rm = T so that R discounts NA's

log_over_time <- investments %>% 
  filter(company_country_code == "USA") %>% 
  group_by(funding_year) %>% 
  summarise(total = sum(raised_amount_usd, na.rm = T)) %>% 
  ggplot(., aes(x = funding_year, y = total/1000)) +
  geom_point() +
  geom_line() +
  theme_classic() +
  scale_y_log10(labels = comma) +
  labs(title = "Total Investments Over Time",
       subtitle = "Data from Dec. 4, 2015 Crunchbase Data Report",
       x = "Year", 
       y = "Billion USD") +
  transition_reveal(funding_year) 

log_over_time
anim_save("log_over_time.gif", log_over_time, path = "Startups")

# total_over_time <- investments %>% 
#   group_by(funding_year) %>% 
#   summarise(total = sum(raised_amount_usd, na.rm = T)) %>% 
#   ggplot(., aes(x = funding_year, y = total)) +
#   geom_point() +
#   geom_line() +
#   theme_classic() +
#   labs(title = "Total Investments Over Time",
#        subtitle = "Data from Dec. 4, 2015 Crunchbase Data Report",
#        x = "Year", 
#        y = "Million USD") +
#   transition_reveal(funding_year)

```

## investments by type over the years

```{r data wrangling, echo = FALSE}

# did some analysis in excel - max number of categories is 23. grouped by
# funding year and category, sorted for top 5 funded startup types.

investments2 <- investments %>% 
  filter(! is.na(raised_amount_usd)) %>% 
  separate(data = ., 
           col = company_category_list, 
           into = c("cat_1", "cat_2", "cat_3","cat_4", "cat_5", "cat_6", "cat_7", "cat_8", "cat_9", "cat_10", "cat_11", "cat_12", "cat_13", "cat_14", "cat_15", "cat_16", "cat_17", "cat_18", "cat_19", "cat_20", "cat_21", "cat_22", "cat_23"),
           sep = "([\\|])", 
           extra = "merge", 
           fill = "right") %>% 
  pivot_longer(
    cols = starts_with("cat_"),
    names_to = "cat_num",
    names_prefix = "cat_",
    values_to = "category",
    values_drop_na = TRUE
 ) %>% 
  filter(company_country_code == "USA")

# finding top ten funded categories, using this as a list to filter within
# top_funded dataset

top_ten <- investments2 %>% 
  group_by(category) %>% 
  summarise(total = sum(raised_amount_usd, na.rm = T)) %>% 
  mutate(total = round(total/1000, digits = 2)) %>% 
  arrange(desc(total)) %>% 
  head(9)

# writing this to shiny to plot top industries
write_rds(top_ten, path = "Startups/top_ten.rds")

top_ten_gt <- top_ten %>% 
  gt() %>% 
  tab_header(
    title = "Top 9 US Startup Industries by Total Funding",
    subtitle = "1979-2015"
  ) %>% 
  cols_label(
    category = "Industry",
    total = "Total Funding (Billion USD)"
  ) %>% 
  cols_align(
    "center"
  ) %>% 
  tab_footnote(
    footnote = "Data from Dec. 4, 2015 Crunchbase Data Report",
    locations = cells_title("title"))
  

# making a line graph to show how they change over time. 
# using a log y scale

nine_industries <- investments2 %>% 
  filter(category %in% top_ten$category[1:9]) %>% 
  mutate(category = as.factor(category)) 

# saving as rds to plot best cities

write_rds(nine_industries, path = "Startups/nine_industries.rds")

ind_funding_over_time <- nine_industries %>% 
  group_by(category, funding_year) %>% 
  mutate(total = sum(raised_amount_usd, na.rm = T)) %>% 
  mutate(total = round(total/1000, digits = 2)) 

# writing this into shiny as well

write_rds(ind_funding_over_time, path = "Startups/ind_funding_over_time.rds")

log_top_funded <- ind_funding_over_time%>% 
  ggplot(., aes(x = funding_year, y = total, color = category)) +
  facet_wrap(~category) +
  geom_point(show.legend = FALSE) +
  geom_line(show.legend = FALSE) +
  labs(title = "US Investments Over Time for Top-Funded Industry, 1979 - 2015",
       subtitle = "Using a log y scale",
       x = "Year",
       y = "Funding (Billion USD)") + 
  scale_y_log10()
  
# regular y axis scale 

reg_top_funded <- ind_funding_over_time %>%
  ggplot(., aes(x = funding_year, y = total, color = category)) +
  facet_wrap(~category) +
  geom_point(show.legend = FALSE) +
  geom_line(show.legend = FALSE) +
  labs(title = "US Investments Over Time for Top-Funded Industry, 1979 - 2015",
       subtitle = "Using a regular y scale",
       x = "Year",
       y = "Funding (Billion USD)") 

# adding animations to both

reg_top_funded + transition_reveal(funding_year)
log_top_funded + transition_reveal(funding_year)

```

# Looking into trends 

## top cities for funding by top 9-funded industries

```{r}

# filtering for top 10 cities with most company funding in US for top 4 industries

# biotech_cities <- nine_industries %>% 
#   filter(category == "Biotechnology") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Biotechnology Funding, until 2015",
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# software_cities <- investments2 %>% 
#   filter(category == "Software") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Software Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# ecom_cities <- investments2 %>% 
#   filter(category == "E-Commerce") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for E-Commerce Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# mobile_cities <- investments2 %>% 
#   filter(category == "Mobile") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Mobile Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# esoft_cities <- investments2 %>% 
#   filter(category == "Enterprise Software") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Enterpise Software Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# health_cities <- investments2 %>% 
#   filter(category == "Health Care") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Health Care Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# cleantech_cities <- investments2 %>% 
#   filter(category == "Clean Technology") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Clean Technology Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# int_cities <- investments2 %>% 
#   filter(category == "Internet") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Internet Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")
# 
# ad_cities <- investments2 %>% 
#   filter(category == "Advertising") %>%
#   filter(! is.na(company_city)) %>% 
#   filter(company_country_code == "USA") %>% 
#   select(raised_amount_usd, company_city, company_state_code) %>% 
#   mutate(company_city = paste(company_city, sep = ", ", company_state_code)) %>% 
#   group_by(company_city) %>% 
#   summarise(total = sum(raised_amount_usd)) %>% 
#   arrange(desc(total)) %>% 
#   head(10) %>% 
#   ggplot(., aes(x = total/1000, y = fct_reorder(company_city, total))) +
#   geom_bar(stat = "identity") +
#   theme_minimal() +
#   labs(title = "Top 10 US Cities for Advertising Funding, until 2015", 
#        subtitle = "Based off of company location",
#        x = "Total Funding (Billion USD)",
#        y = "Company Cities")

# ggsave("biotech_cities.png", plot = biotech_cities, path = "Startups")
# ggsave("software_cities.png", plot = software_cities, path = "Startups")
# ggsave("ecom_cities.png", plot = ecom_cities, path = "Startups")
# ggsave("esoft_cities.png", plot = esoft_cities, path = "Startups")
# ggsave("mobile_cities.png", plot = mobile_cities, path = "Startups")
# ggsave("health_cities.png", plot = health_cities, path = "Startups")
# ggsave("cleantech_cities.png", plot = cleantech_cities, path = "Startups")
# ggsave("int_cities.png", plot = int_cities, path = "Startups")
# ggsave("ad_cities.png", plot = ad_cities, path = "Startups")

# biotech_cities
# software_cities
# ecom_cities
# mobile_cities
# esoft_cities
# health_cities
# cleantech_cities
# int_cities
# ad_cities

```


# What geopolitical factors influence a startup's success?

## Case Study of CA

```{r CA, echo = FALSE}

# obtaining hs education pop in each state, bachelor's pop, and income. 2015 acs
# refers to last five years, so I will be using startup data from 2011-2015.

hs_education <- get_acs(geography = "state",
                        variables = c("B15003_017"),
                        year = 2015,
                        survey = "acs5", 
                        summary_var = "B15002_001") %>% 
  select(-GEOID) 

ba_education <- get_acs(geography = "state",
                        variables = "B15003_022",
                        year = 2015,
                        survey = "acs5",
                        summary_var = "B15002_001") %>% 
  select(-GEOID)

# downloading higher institution data from: https://hifld-geoplatform.opendata.arcgis.com/datasets/colleges-and-universities/data. Cleaned up in excel first to make it easier to read in.

colleges <- read_csv("raw-data/Colleges_and_Universities.csv", 
                     col_types = cols(
  NAME = col_character(),
  ADDRESS = col_character(),
  CITY = col_character(),
  STATE = col_character(),
  ZIP = col_double(),
  POPULATION = col_double(),
  COUNTY = col_character(),
  COUNTYFIPS = col_character(),
  COUNTRY = col_character(),
  LATITUDE = col_double(),
  LONGITUDE = col_double()
))

# running a regression on # of startups founded based off of state education
# (high school and bachelors - proportion of people over 25 with HS and BA - had
# to divide by pop over 25) n = number of startups founded between 2011-2015.

# getting variables in place. calculating proportions. Lots of renaming and
# reformatting to get the tibble to be organized.

companies_per_state <- companies %>% 
  filter(country_code == "USA") %>%
  filter(!is.na(state_code)) %>% 
  mutate(found_year = as.numeric(format(founded_at, "%Y"))) %>% 
  filter(found_year <= 2015 & found_year >= 2011) %>% 
  select(found_year, state_code, name) %>% 
  group_by(state_code) %>% 
  count() %>% 
  left_join(stateabbr,
            by = c("state_code" = "Code")) %>% 
  filter(!is.na(State)) 

# creating a new dataset by joining with acs data and reorganizing names

full_education <- companies_per_state %>% 
  full_join(hs_education, by = c("State" = "NAME")) %>% 
  select(-variable, -moe, -summary_est, -summary_moe) %>% 
  rename(hs_estimate = "estimate") %>% 
  full_join(ba_education, by = c("State" = "NAME")) %>% 
  select(-variable, -moe, -summary_moe) %>% 
  rename(ba_estimate = "estimate") %>% 
  mutate(n = as.double(n))

# performing multiple regression

multi_model <- full_education %>% 
  lm(n ~ hs_estimate + ba_estimate, data = .) %>% 
  tidy(conf.int = TRUE) %>%  
  select(term, estimate, conf.low, conf.high) %>%
  mutate(estimate = round(estimate, digits = 4), 
         conf.low = round(conf.low, digits = 4), 
         conf.high = round(conf.high, digits = 4)) 

# making the gt table

edu_gt <- multi_model %>% 
  gt() %>% 
  tab_header(
    title = "Effect of Educational Attainment on Number of Startups Founded in 2011-2015
",
    subtitle = "Using 2011-2015 ACS Data for People 25 years or older
"
  ) %>% 
   cols_label(
    term = "Variable",
    estimate = "Estimate",
    conf.low = "Lower bound",
    conf.high = "Upper bound"
  ) %>% 
  cols_align(
    "center"
  )

edu_gt

# organizing college dataset by adding in abbreviations to make  joining with
# exisitng data easier

full_colleges <- colleges %>% 
  group_by(STATE) %>% 
  count() %>% 
  rename(inst_count = "n") %>% 
  full_join(companies_per_state, by = c("STATE" = "state_code")) %>% 
  filter(! is.na(STATE)) %>% 
  rename(startup_count = "n")

# writing data to shiny

write_rds(full_colleges, path = "Startups/full_colleges.rds")

# creating the regression

inst_model <- full_colleges %>% 
  lm(startup_count ~ inst_count, data = .) %>% 
  tidy(conf.int = TRUE) %>% 
  select(term, estimate, conf.low, conf.high) %>%
  mutate(estimate = round(estimate, digits = 3), 
         conf.low = round(conf.low, digits = 3), 
         conf.high = round(conf.high, digits = 3))

#gt table

inst_gt <- inst_model %>% 
  gt() %>% 
  tab_header(
    title = "Effect of Number of Higher Level Institutions on Number of Startups Founded in 2011-2015
",
    subtitle = "Using College and University Data from US Dept. of Homeland Security
"
  ) %>% 
   cols_label(
    term = "Variable",
    estimate = "Estimate",
    conf.low = "Lower bound",
    conf.high = "Upper bound"
  ) %>% 
  cols_align(
    "center"
  )

inst_gt

```

## making a ggplot of regressions

```{r visualizing reg, echo = FALSE}

# creating a ggplot of the regression that yielded more results

reg_plot <- full_colleges %>% 
  na.omit() %>% 
  ggplot(., aes(x = inst_count, y = startup_count)) +
  geom_point() +
  geom_smooth(method = "lm", se = FALSE) +
  labs(title = "Relationship between number of higher instituions and number of new startups",
       subtitle = "2011-2015, each point represents a state",
       x = "Number of Higher Institutions",
       y = "Number of Startups Founded")

# saving as png

ggsave("reg_plot.png", plot = reg_plot, path = "Startups")

```


next steps: 
- make a map of most common type of startup by state
- top 3 types of startups by state
- make this interactive

todo:
- investments over time: fix y axis
- investments over time by industry: fix y axis
- worldwide vs. in the US
- total funding in cities vs. income
  - do this by industry
- choose top 4 cities
- reformat axes
- add in states
